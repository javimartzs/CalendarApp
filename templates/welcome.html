<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Bienvenido</title>
    <!-- Bootstrap CSS -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet">
</head>
<body class="d-flex flex-column min-vh-100">

    <header class="w-100 bg-primary p-3 shadow">
        <h1 class="text-center text-white fst-italic">Gestor de trabajadores y horarios</h1>
    </header>

    <div class="container my-4 flex-grow-1">
        <!-- Mensaje de Bienvenida y Botón de Cerrar Sesión -->
        <div class="d-flex justify-content-between align-items-center mb-4">
            <h2 class="mb-0">Bienvenido !!</h2>
            <form action="/logout" method="POST">
                <button type="submit" class="btn btn-danger">Cerrar sesión</button>
            </form>
        </div>

        <!-- Formulario y Tabla de Trabajadores -->
        <div class="row">
            <div class="col-md-6">
                <h3>Nuevo Trabajador</h3>
                <form id="workerForm" action="/welcome" method="POST">
                    <input type="hidden" id="workerId" name="workerId">
                    <div class="mb-3">
                        <label for="firstname" class="form-label">Nombre:</label>
                        <input type="text" class="form-control" id="firstname" name="firstname" required>
                    </div>
                    <div class="mb-3">
                        <label for="lastname" class="form-label">Apellido:</label>
                        <input type="text" class="form-control" id="lastname" name="lastname" required>
                    </div>
                    <div class="mb-3">
                        <label for="phone" class="form-label">Teléfono:</label>
                        <input type="number" class="form-control" id="phone" name="phone" required>
                    </div>
                    <div class="mb-3">
                        <label for="store" class="form-label">TIenda habitual:</label>
                        <select name="store" id="store" class="form-control">
                            <option value="" disabled selected hidden></option>
                            <option value="Calle Barcelona">Calle Barcelona</option>
                            <option value="Plaza de Lugo">Plaza de Lugo</option>
                            <option value="Calle Real">Calle Real</option>
                            <option value="Los Mallos">Los Mallos</option>
                            <option value="Av. Finistere">Av. Finistere</option>
                            <option value="Cuatro Caminos">Cuatro Caminos</option>
                            <option value="Av. de Oza">Av. de Oza</option>
                        </select>
                    </div>
                    <div class="d-flex justify-content-between">
                        <button type="submit" class="btn btn-primary">Agregar/Actualizar Trabajador</button>
                    </div>
                </form>
                <div class="d-flex justify-content-between">
                    <form action="/calendar" method="GET">
                        <button type="submit" class="btn btn-primary mt-2">Calendario</button>
                    </form>
                </div>
            </div>
            <div class="col-md-6">
                <h3>Lista de Trabajadores</h3>
                <table class="table" id="workerTable">
                    <thead>
                        <tr>
                            <th>Nombre</th>
                            <th>Apellido</th>
                            <th>Tienda habitual</th>
                            <th>Acciones</th>
                        </tr>
                    </thead>
                    <tbody>
                        {{range .Workers}}
                        <tr data-id="{{.ID}}">
                            <td><a href="/worker/{{.ID}}">{{.Firstname}}</a></td>
                            <td>{{.Lastname}}</td>
                            <td>{{.Store}}</td>
                            <td>
                                <button class="btn btn-light btn-edit" data-id="{{.ID}}" data-firstname="{{.Firstname}}" data-lastname="{{.Lastname}}" data-phone="{{.Phone}}" data-store="{{.Store}}">Editar</button>
                            </td>
                        </tr>
                        {{end}}
                    </tbody>
                </table>
            </div>
        </div>
    </div>
    <footer class="w-100 bg-primary mt-5 p-3">
        <h5 class="text-center text-white fst-italic">Amasarte 2024 - Todos los derechos reservados</h5>
    </footer>

    <!-- Bootstrap JS y dependencias -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js"></script>

    <script>
        document.querySelectorAll('.btn-edit').forEach(function(button) {
            button.addEventListener('click', function() {
                var workerId = this.getAttribute('data-id');
                var firstname = this.getAttribute('data-firstname');
                var lastname = this.getAttribute('data-lastname');
                var phone = this.getAttribute('data-phone');
                var store = this.getAttribute('data-store');

                document.getElementById('workerId').value = workerId;
                document.getElementById('firstname').value = firstname;
                document.getElementById('lastname').value = lastname;
                document.getElementById('phone').value = phone;
                document.getElementById('store').value = store;
            });
        });

    </script></body>
</html>
